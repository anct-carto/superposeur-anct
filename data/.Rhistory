acv_geom<-ma_fonction(acv_init, type="ctr")%>%
rename("id_geo"="insee_com", "lib_geo"="lib_com.y" ,"id_territoire"="id_acv", "lib_territoire"="lib_acv")%>%
select(id_geo, lib_geo, id_territoire, lib_territoire, date_signature)%>%
group_by(id_geo, lib_geo, id_territoire, lib_territoire)%>%
summarise(liste_geo= paste0(unique(id_geo),' (', id_geo, ')', collapse = '; '),
)
#ACV
acv_geom<-ma_fonction(acv_init, type="ctr")%>%
rename("id_geo"="insee_com", "lib_geo"="lib_com.y" ,"id_territoire"="id_acv", "lib_territoire"="lib_acv")%>%
select(id_geo, lib_geo, id_territoire, lib_territoire, date_signature)%>%
group_by(id_geo, lib_geo, id_territoire, lib_territoire)%>%
summarise(liste_geo= paste0(unique(lib_geo),' (', id_geo, ')', collapse = '; '),
)
#ACV
acv_geom<-ma_fonction(acv_init, type="ctr")%>%
rename("id_geo"="insee_com", "lib_geo"="lib_com.y" ,"id_territoire"="id_acv", "lib_territoire"="lib_acv")%>%
select(id_geo, lib_geo, id_territoire, lib_territoire, date_signature)%>%
group_by(id_geo, lib_geo, id_territoire)%>%
summarise(liste_geo= paste0(unique(lib_geo),' (', id_geo, ')', collapse = '; '),
)
#ACV
acv_geom<-ma_fonction(acv_init, type="ctr")%>%
rename("id_geo"="insee_com", "lib_geo"="lib_com.y" ,"id_territoire"="id_acv", "lib_territoire"="lib_acv")%>%
select(id_geo, lib_geo, id_territoire, lib_territoire, date_signature)%>%
group_by(id_territoire)%>%
summarise(liste_geo= paste0(unique(lib_geo),' (', id_geo, ')', collapse = '; '),
)
#ACV
acv_geom<-ma_fonction(acv_init, type="ctr")%>%
rename("id_geo"="insee_com", "lib_geo"="lib_com.y" ,"id_territoire"="id_acv", "lib_territoire"="lib_acv")%>%
select(id_geo, lib_geo, id_territoire, lib_territoire, date_signature)%>%
group_by(id_territoire)%>%
summarise(liste_geo= paste0(unique(lib_geo),' (', id_geo, ')', collapse = '; '),
lib_territoire=lib_territoire
)
#ACV
acv_geom<-ma_fonction(acv_init, type="ctr")%>%
rename("id_geo"="insee_com", "lib_geo"="lib_com.y" ,"id_territoire"="id_acv", "lib_territoire"="lib_acv")%>%
select(id_geo, lib_geo, id_territoire, lib_territoire, date_signature)%>%
group_by(id_territoire)%>%
summarise(liste_geo= paste0(unique(lib_geo),' (', id_geo, ')', collapse = '; '),
lib_territoire=lib_territoire,
)
View(acv_geom)
#ACV
acv_geom<-ma_fonction(acv_init, type="ctr")%>%
rename("id_geo"="insee_com", "lib_geo"="lib_com.y" ,"id_territoire"="id_acv", "lib_territoire"="lib_acv")%>%
select(id_geo, lib_geo, id_territoire, lib_territoire, date_signature)%>%
group_by(id_territoire)%>%
summarise(liste_geo= paste0(unique(lib_geo),' (', id_geo, ')', collapse = '; '),
lib_territoire=lib_territoire,
date_signature=date_signature
)
#ACV
acv_geom<-ma_fonction(acv_init, type="ctr")%>%
rename("id_geo"="insee_com", "lib_geo"="lib_com.y" ,"id_territoire"="id_acv", "lib_territoire"="lib_acv")%>%
select(id_geo, lib_geo, id_territoire, lib_territoire, date_signature)%>%
group_by(id_territoire)%>%
summarise(liste_geo= paste0(unique(lib_geo),' (', id_geo, ')', collapse = '; '),
lib_territoire=lib_territoire,
date_signature=date_signature,)
#ACV
acv_geom<-ma_fonction(acv_init, type="ctr")%>%
rename("id_geo"="insee_com", "lib_geo"="lib_com.y" ,"id_territoire"="id_acv", "lib_territoire"="lib_acv")%>%
select(id_geo, lib_geo, id_territoire, lib_territoire, date_signature)%>%
group_by(id_territoire,lib_territoire, date_signature)%>%
summarise(liste_geo= paste0(unique(lib_geo),' (', id_geo, ')', collapse = '; '),
lib_territoire=lib_territoire,
date_signature=date_signature,)
#ACV
acv_geom<-ma_fonction(acv_init, type="ctr")%>%
rename("id_geo"="insee_com", "lib_geo"="lib_com.y" ,"id_territoire"="id_acv", "lib_territoire"="lib_acv")%>%
select(id_geo, lib_geo, id_territoire, lib_territoire, date_signature)%>%
group_by(id_territoire)%>%
summarise(liste_geo= paste0(unique(lib_geo),' (', id_geo, ')', collapse = '; '),
lib_territoire2=lib_territoire,
date_signature2=date_signature)
acv_geom<-ma_fonction(acv_init, type="ctr")%>%
rename("id_geo"="insee_com", "lib_geo"="lib_com.y" ,"id_territoire"="id_acv", "lib_territoire"="lib_acv")%>%
select(id_geo, lib_geo, id_territoire, lib_territoire, date_signature)%>%
group_by(id_territoire)
#ACV
acv_geom<-ma_fonction(acv_init, type="ctr")%>%
rename("id_geo"="insee_com", "lib_geo"="lib_com.y" ,"id_territoire"="id_acv", "lib_territoire"="lib_acv")%>%
select(id_geo, lib_geo, id_territoire, lib_territoire, date_signature)%>%
group_by(id_territoire)%>%
summarise(liste_geo= paste0(unique(lib_geo),' (', id_geo, ')', collapse = '; '),
lib_territoire="lib_territoire",
date_signature="date_signature")
#ACV
acv_geom<-ma_fonction(acv_init, type="ctr")%>%
rename("id_geo"="insee_com", "lib_geo"="lib_com.y" ,"id_territoire"="id_acv", "lib_territoire"="lib_acv")%>%
select(id_geo, lib_geo, id_territoire, lib_territoire, date_signature)%>%
group_by(id_territoire)%>%
summarise(liste_geo= paste0(unique(lib_geo),' (', id_geo, ')', collapse = '; '),
lib_territoire=paste(lib_territoire),
date_signature=paste(date_signature))
acv_geom<-ma_fonction(acv_init, type="ctr")%>%
rename("id_geo"="insee_com", "lib_geo"="lib_com.y" ,"id_territoire"="id_acv", "lib_territoire"="lib_acv")%>%
select(id_geo, lib_geo, id_territoire, lib_territoire, date_signature)%>%
group_by(id_territoire)
#ACV
acv_geom<-ma_fonction(acv_init, type="ctr")%>%
rename("id_geo"="insee_com", "lib_geo"="lib_com.y" ,"id_territoire"="id_acv", "lib_territoire"="lib_acv")%>%
select(id_geo, lib_geo, id_territoire, lib_territoire, date_signature)%>%
group_by(id_territoire, lib_territoire)%>%
summarise(liste_geo= paste0(unique(lib_geo),' (', id_geo, ')', collapse = '; '),
lib_territoire=lib_territoire,
date_signature=date_signature)
#ACV
acv_geom<-ma_fonction(acv_init, type="ctr")%>%
rename("id_geo"="insee_com", "lib_geo"="lib_com.y" ,"id_territoire"="id_acv", "lib_territoire"="lib_acv")%>%
select(id_geo, lib_geo, id_territoire, lib_territoire, date_signature)%>%
group_by(id_territoire, lib_territoire)%>%
summarise(liste_geo= paste0(unique(lib_geo),' (', id_geo, ')', collapse = '; '),
lib_territoire=lib_territoire)
#ACV
acv_geom<-ma_fonction(acv_init, type="ctr")%>%
rename("id_geo"="insee_com", "lib_geo"="lib_com.y" ,"id_territoire"="id_acv", "lib_territoire"="lib_acv")%>%
select(id_geo, lib_geo, id_territoire, lib_territoire, date_signature)%>%
group_by(id_territoire, lib_territoire)%>%
summarise(liste_geo= paste0(unique(lib_geo),' (', id_geo, ')', collapse = '; '),
liste_territoire=lib_territoire)
#ACV
acv_geom<-ma_fonction(acv_init, type="ctr")%>%
rename("id_geo"="insee_com", "lib_geo"="lib_com.y" ,"id_territoire"="id_acv", "lib_territoire"="lib_acv")%>%
select(id_geo, lib_geo, id_territoire, lib_territoire, date_signature)%>%
group_by(id_territoire, lib_territoire)%>%
reframe(liste_geo= paste0(unique(lib_geo),' (', id_geo, ')', collapse = '; '),
lib_territoire=lib_territoire)
#ACV
acv_geom<-ma_fonction(acv_init, type="ctr")%>%
rename("id_geo"="insee_com", "lib_geo"="lib_com.y" ,"id_territoire"="id_acv", "lib_territoire"="lib_acv")%>%
select(id_geo, lib_geo, id_territoire, lib_territoire, date_signature)%>%
group_by(id_territoire, lib_territoire)%>%
summarise(liste_geo= paste0(unique(lib_geo),' (', id_geo, ')', collapse = '; '),
lib_territoire=lib_territoire)
#ACV
acv_geom<-ma_fonction(acv_init, type="ctr")%>%
rename("id_geo"="insee_com", "lib_geo"="lib_com.y" ,"id_territoire"="id_acv", "lib_territoire"="lib_acv")%>%
select(id_geo, lib_geo, id_territoire, lib_territoire, date_signature)%>%
group_by(id_territoire, lib_territoire)%>%
summarise(liste_geo= paste0(unique(lib_geo),' (', id_geo, ')', collapse = '; '))
#ACV
acv_geom<-ma_fonction(acv_init, type="ctr")%>%
rename("id_geo"="insee_com", "lib_geo"="lib_com.y" ,"id_territoire"="id_acv", "lib_territoire"="lib_acv")%>%
select(id_geo, lib_geo, id_territoire, lib_territoire, date_signature)%>%
group_by(id_territoire, lib_territoire, date_signature)%>%
summarise(liste_geo= paste0(unique(lib_geo),' (', id_geo, ')', collapse = '; '))
#ACV2
acv2_geom<-ma_fonction(acv2_init, type="ctr")%>%
rename("id_geo"="insee_com", "lib_geo"="lib_com.y" ,"id_territoire"="id_acv2", "lib_territoire"="lib_acv2")%>%
select(id_geo, lib_geo, id_territoire, lib_territoire)%>%
group_by(id_territoire, lib_territoire)%>%
summarise(liste_geo= paste0(unique(lib_geo),' (', id_geo, ')', collapse = '; '))
View(acv2_geom)
#PVD
pvd_geom<-ma_fonction(pvd_init, type="ctr")%>%
rename("id_geo"="insee_com", "lib_geo"="lib_com.y" ,"id_territoire"="id_pvd", "lib_territoire"="lib_com_carto")%>%
select(id_geo, lib_geo, id_territoire, lib_territoire, date_signature)%>%
group_by(id_territoire, lib_territoire, date_signature)%>%
summarise(liste_geo= paste0(unique(lib_geo),' (', id_geo, ')', collapse = '; '))
View(pvd_geom)
test <- pvd_geom%>%
group_by(id_territoire)
#FS
fs_geom<-ma_fonction(fs_init, type="ctr")%>%
rename("id_geo"="insee_com", "lib_geo"="lib_com.y" ,"id_territoire"="id_fs", "lib_territoire"="lib_com_carto")%>%
select(id_geo, lib_geo, id_territoire, lib_territoire)%>%
group_by(id_territoire, lib_territoire)%>%
summarise(liste_geo= paste0(unique(lib_geo),' (', id_geo, ')', collapse = '; '))
View(fs_geom)
#TI
ti_init <- read.csv("N:/Transverse/Donnees_Obs/Donnees_Statistiques/ANCT/territoires-industrie/liste-ti-20231107.csv", fileEncoding ="utf-8")
ti_geom<-ma_fonction(ti_init, type="polygon")%>%
group_by(id_ti, lib_ti) %>%
summarise()
ti_geom<-ma_fonction(ti_init, type="polygon")
View(ti_init)
#TI
ti_init <- read.csv("N:/Transverse/Donnees_Obs/Donnees_Statistiques/ANCT/territoires-industrie/liste-ti-com2023-20231107.csv", fileEncoding ="utf-8")
ti_geom<-ma_fonction(ti_init, type="polygon")%>%
group_by(id_ti, lib_ti) %>%
summarise()
View(ti_geom)
ti_geom<-ma_fonction(ti_init, type="polygon")%>%
rename("id_geo"="insee_com", "lib_geo"="lib_com.y" ,"id_territoire"="id_ti", "lib_territoire"="lib_ti")%>%
select(id_geo, lib_geo, id_territoire, lib_territoire)%>%
group_by(id_territoire, lib_territoire)%>%
summarise(liste_geo= paste0(unique(lib_geo),' (', id_geo, ')', collapse = '; '))
#Avenir montagne ing√©nierie
ami_init <- read.csv("N:/Transverse/Donnees_Obs/Donnees_Statistiques/ANCT/avenir-montagnes-ingenierie/liste-ami-com2023-20230830.csv", fileEncoding ="utf-8")
ami_init_list <- read.csv("N:/Transverse/Donnees_Obs/Donnees_Statistiques/ANCT/avenir-montagnes-ingenierie/liste-ami-20230830.csv", fileEncoding ="utf-8")
ami_groupement <- read.csv("N:/Transverse/Donnees_Obs/Donnees_Statistiques/ANCT/avenir-montagnes-ingenierie/liste-ami-grpt2023-20230830.csv", fileEncoding ="utf-8")
View(amm_geom)
#AMM
amm_geom<-ma_fonction(amm_init, type="polygon")%>%
separate_rows(id_amm, sep = " ; ")%>%
rename("id_geo"="insee_com", "lib_geo"="lib_com.y" ,"id_territoire"="id_amm", "lib_territoire"="lib_porteur")%>%
select(id_geo, lib_geo, id_territoire, lib_territoire)%>%
group_by(id_territoire)%>%
summarise()%>%
left_join(amm_init_list, by = c("id_territoire"="id_amm"))%>%
left_join(amm_gpt_data, by= c("id_territoire"="id_amm") )%>%
rename("lib_territoire"="lib_porteur")
View(ami_init)
ami_geom<-ma_fonction(ami_init, type="polygon")%>%
separate_rows(id_ami, sep = " ; ") %>%
rename("id_geo"="insee_com", "lib_geo"="lib_com" ,"id_territoire"="id_ami", "lib_territoire"="lib_ami")%>%
select(id_geo, lib_geo, id_territoire, lib_territoire)%>%
group_by(id_territoire)
ami_geom<-ma_fonction(ami_init, type="polygon")%>%
separate_rows(id_ami, sep = " ; ") %>%
rename("id_geo"="insee_com", "lib_geo"="lib_com.y" ,"id_territoire"="id_ami", "lib_territoire"="lib_ami")%>%
select(id_geo, lib_geo, id_territoire, lib_territoire)
View(ami_geom)
ami_geom<-ma_fonction(ami_init, type="polygon")%>%
separate_rows(id_ami, sep = " ; ") %>%
rename("id_geo"="insee_com", "lib_geo"="lib_com.y" ,"id_territoire"="id_ami", "lib_territoire"="lib_ami")%>%
select(id_geo, lib_geo, id_territoire, lib_territoire)%>%
group_by(id_territoire)%>%
summarise()
ami_geom<-ma_fonction(ami_init, type="polygon")%>%
separate_rows(id_ami, sep = " ; ") %>%
rename("id_geo"="insee_com", "lib_geo"="lib_com.y" ,"id_territoire"="id_ami", "lib_territoire"="lib_ami")%>%
select(id_geo, lib_geo, id_territoire, lib_territoire)%>%
group_by(id_territoire)%>%
summarise()%>%
left_join(amm_init_list, by = c("id_territoire"="id_ami"))%>%
left_join(amm_gpt_data, by= c("id_territoire"="id_ami") )%>%
rename("lib_territoire"="lib_ami")
#AMI
ami_geom<-ma_fonction(ami_init, type="polygon")%>%
separate_rows(id_ami, sep = " ; ") %>%
rename("id_geo"="insee_com", "lib_geo"="lib_com.y" ,"id_territoire"="id_ami", "lib_territoire"="lib_ami")%>%
select(id_geo, lib_geo, id_territoire, lib_territoire)%>%
group_by(id_territoire)%>%
summarise()%>%
left_join(ami_init_list, by = c("id_territoire"="id_ami"))%>%
left_join(ami_gpt_data, by= c("id_territoire"="id_ami") )%>%
rename("lib_territoire"="lib_ami")
ami_gpt_data <- ami_groupement %>%
group_by(id_ami)%>%
summarise(liste_geo= paste0(unique(lib_groupement),' (', siren_groupement, ')', collapse = '; '),
)
View(ami_gpt_data)
#AMI
ami_geom<-ma_fonction(ami_init, type="polygon")%>%
separate_rows(id_ami, sep = " ; ") %>%
rename("id_geo"="insee_com", "lib_geo"="lib_com.y" ,"id_territoire"="id_ami", "lib_territoire"="lib_ami")%>%
select(id_geo, lib_geo, id_territoire, lib_territoire)%>%
group_by(id_territoire)%>%
summarise()%>%
left_join(ami_init_list, by = c("id_territoire"="id_ami"))%>%
left_join(ami_gpt_data, by= c("id_territoire"="id_ami") )%>%
rename("lib_territoire"="lib_ami")
View(ami_groupement)
View(ami_groupement)
ami_gpt_data <- ami_groupement %>%
group_by(id_ami)%>%
summarise(liste_geo= paste0(unique(lib_groupement),' (', siren_groupement, ')', collapse = '; '),
lib_massif=lib_massif
)
View(ami_init)
View(ami_init_list)
ami_geom<-ma_fonction(ami_init, type="polygon")%>%
separate_rows(id_ami, sep = " ; ") %>%
rename("id_geo"="insee_com", "lib_geo"="lib_com.y" ,"id_territoire"="id_ami", "lib_territoire"="lib_ami")%>%
select(id_geo, lib_geo, id_territoire, lib_territoire)%>%
group_by(id_territoire)%>%
summarise()
ami_geom<-ma_fonction(ami_init, type="polygon")%>%
separate_rows(id_ami, sep = " ; ") %>%
rename("id_geo"="insee_com", "lib_geo"="lib_com.y" ,"id_territoire"="id_ami", "lib_territoire"="lib_ami")%>%
select(id_geo, lib_geo, id_territoire, lib_territoire)%>%
group_by(id_territoire)%>%
summarise()%>%
left_join(ami_init_list, by = c("id_territoire"="id_ami"))
View(ami_geom)
View(ami_init)
df <- ami_init_list %>% add_count(id_ami) %>% filter(n>1)
View(df)
View(df)
View(df)
#AMI
ami_geom<-ma_fonction(ami_init, type="polygon")%>%
separate_rows(id_ami, sep = " ; ") %>%
rename("id_geo"="insee_com", "lib_geo"="lib_com.y" ,"id_territoire"="id_ami", "lib_territoire"="lib_ami")%>%
select(id_geo, lib_geo, id_territoire, lib_territoire)%>%
group_by(id_territoire)%>%
summarise()%>%
left_join(ami_init_list, by = c("id_territoire"="id_ami"))%>%
left_join(ami_gpt_data, by= c("id_territoire"="id_ami") )%>%
rename("lib_territoire"="lib_ami")%>%
filter(lib_territoire!= "Sites nordiques des Hautes-Vosges" & lib_territoire!= "PNR Ballon des Vosges")
#AMI
ami_geom<-ma_fonction(ami_init, type="polygon")%>%
separate_rows(id_ami, sep = " ; ") %>%
rename("id_geo"="insee_com", "lib_geo"="lib_com.y" ,"id_territoire"="id_ami", "lib_territoire"="lib_ami")%>%
select(id_geo, lib_geo, id_territoire, lib_territoire)%>%
group_by(id_territoire)%>%
summarise()%>%
left_join(ami_init_list, by = c("id_territoire"="id_ami"))%>%
left_join(ami_gpt_data, by= c("id_territoire"="id_ami") )%>%
rename("lib_territoire"="lib_ami")
View(ami_geom)
ami_geom<-ma_fonction(ami_init, type="polygon")%>%
separate_rows(id_ami, sep = " ; ") %>%
rename("id_geo"="insee_com", "lib_geo"="lib_com.y" ,"id_territoire"="id_ami", "lib_territoire"="lib_ami")%>%
select(id_geo, lib_geo, id_territoire, lib_territoire)%>%
group_by(id_territoire)%>%
summarise()
View(ami_geom)
ami_geom<-ma_fonction(ami_init, type="polygon")%>%
separate_rows(id_ami, sep = " ; ") %>%
rename("id_geo"="insee_com", "lib_geo"="lib_com.y" ,"id_territoire"="id_ami", "lib_territoire"="lib_ami")%>%
select(id_geo, lib_geo, id_territoire, lib_territoire)%>%
group_by(id_territoire)%>%
summarise()%>%
left_join(ami_init_list, by = c("id_territoire"="id_ami"))
View(ami_geom)
ami_geom<-ma_fonction(ami_init, type="polygon")%>%
separate_rows(id_ami, sep = " ; ") %>%
rename("id_geo"="insee_com", "lib_geo"="lib_com.y" ,"id_territoire"="id_ami", "lib_territoire"="lib_ami")%>%
select(id_geo, lib_geo, id_territoire, lib_territoire)%>%
group_by(id_territoire)%>%
summarise()%>%
left_join(ami_init_list, by = c("id_territoire"="id_ami"))%>%
filter(lib_territoire!= "Sites nordiques des Hautes-Vosges" & lib_territoire!= "PNR Ballon des Vosges")
#AMI
ami_geom<-ma_fonction(ami_init, type="polygon")%>%
separate_rows(id_ami, sep = " ; ") %>%
rename("id_geo"="insee_com", "lib_geo"="lib_com.y" ,"id_territoire"="id_ami", "lib_territoire"="lib_ami")%>%
select(id_geo, lib_geo, id_territoire, lib_territoire)%>%
group_by(id_territoire)%>%
summarise()%>%
rename("lib_territoire"="lib_ami")%>%
left_join(ami_init_list, by = c("id_territoire"="id_ami"))
ami_geom<-ma_fonction(ami_init, type="polygon")%>%
separate_rows(id_ami, sep = " ; ") %>%
rename("id_geo"="insee_com", "lib_geo"="lib_com.y" ,"id_territoire"="id_ami", "lib_territoire"="lib_ami")%>%
select(id_geo, lib_geo, id_territoire, lib_territoire)%>%
group_by(id_territoire)%>%
summarise()%>%
left_join(ami_init_list, by = c("id_territoire"="id_ami"))
#AMI
ami_geom<-ma_fonction(ami_init, type="polygon")%>%
separate_rows(id_ami, sep = " ; ") %>%
rename("id_geo"="insee_com", "lib_geo"="lib_com.y" ,"id_territoire"="id_ami", "lib_territoire"="lib_ami")%>%
select(id_geo, lib_geo, id_territoire, lib_territoire)%>%
group_by(id_territoire)%>%
summarise()%>%
left_join(ami_init_list, by = c("id_territoire"="id_ami"))%>%
rename("lib_territoire"="lib_ami") %>%
filter(lib_territoire!= "Sites nordiques des Hautes-Vosges" & lib_territoire!= "PNR Ballon des Vosges")
View(ami_geom)
View(ami_gpt_data)
View(amm_gpt_data)
View(ami_groupement)
View(ami_gpt_data)
View(ami_groupement)
ami_gpt_data <- ami_groupement %>%
group_by(id_ami)%>%
summarise(liste_geo= paste0(unique(lib_groupement),' (', siren_groupement, ')', collapse = '; '),
)
#AMI
ami_geom<-ma_fonction(ami_init, type="polygon")%>%
separate_rows(id_ami, sep = " ; ") %>%
rename("id_geo"="insee_com", "lib_geo"="lib_com.y" ,"id_territoire"="id_ami", "lib_territoire"="lib_ami")%>%
select(id_geo, lib_geo, id_territoire, lib_territoire)%>%
group_by(id_territoire)%>%
summarise()%>%
left_join(ami_init_list, by = c("id_territoire"="id_ami"))%>%
rename("lib_territoire"="lib_ami") %>%
filter(lib_territoire!= "Sites nordiques des Hautes-Vosges" & lib_territoire!= "PNR Ballon des Vosges")%>%
left_join(ami_gpt_data, by="id_territoire")
View(ami_gpt_data)
#AMI
ami_geom<-ma_fonction(ami_init, type="polygon")%>%
separate_rows(id_ami, sep = " ; ") %>%
rename("id_geo"="insee_com", "lib_geo"="lib_com.y" ,"id_territoire"="id_ami", "lib_territoire"="lib_ami")%>%
select(id_geo, lib_geo, id_territoire, lib_territoire)%>%
group_by(id_territoire)%>%
summarise()%>%
left_join(ami_init_list, by = c("id_territoire"="id_ami"))%>%
rename("lib_territoire"="lib_ami") %>%
filter(lib_territoire!= "Sites nordiques des Hautes-Vosges" & lib_territoire!= "PNR Ballon des Vosges")%>%
left_join(ami_gpt_data, by= c("id_territoire"="id_ami") )
View(ami_geom)
View(ami_gpt_data)
View(ami_init_list)
View(ami_init)
View(ami_init_list)
View(ami_groupement)
View(ami_init_list)
View(ami_groupement)
ami_gpt_data <- ami_groupement %>%
group_by(id_ami)%>%
summarise(liste_geo= paste0(unique(lib_groupement),' (', siren_groupement, ')', collapse = '; '),
massif=massif
)
ami_gpt_data <- ami_groupement %>%
group_by(id_ami, massif)%>%
summarise(liste_geo= paste0(unique(lib_groupement),' (', siren_groupement, ')', collapse = '; '),
massif=massif
)
View(ami_groupement)
ami_gpt_data <- ami_groupement %>%
group_by(id_ami, lib_massif)%>%
summarise(liste_geo= paste0(unique(lib_groupement),' (', siren_groupement, ')', collapse = '; '),
massif=massif
)
ami_gpt_data <- ami_groupement %>%
group_by(id_ami, lib_massif)%>%
summarise(liste_geo= paste0(unique(lib_groupement),' (', siren_groupement, ')', collapse = '; '),
lib_massif=lib_massif
)
View(ami_groupement)
View(ami_gpt_data)
ami_gpt_data <- ami_groupement %>%
group_by(id_ami, lib_massif)%>%
summarise(liste_geo= paste0(unique(lib_groupement),' (', siren_groupement, ')', collapse = '; ')
)
View(ami_gpt_data)
#AMI
ami_geom<-ma_fonction(ami_init, type="polygon")%>%
separate_rows(id_ami, sep = " ; ") %>%
rename("id_geo"="insee_com", "lib_geo"="lib_com.y" ,"id_territoire"="id_ami", "lib_territoire"="lib_ami")%>%
select(id_geo, lib_geo, id_territoire, lib_territoire)%>%
group_by(id_territoire)%>%
summarise()%>%
left_join(ami_init_list, by = c("id_territoire"="id_ami"))%>%
rename("lib_territoire"="lib_ami") %>%
filter(lib_territoire!= "Sites nordiques des Hautes-Vosges" & lib_territoire!= "PNR Ballon des Vosges")%>%
left_join(ami_gpt_data, by= c("id_territoire"="id_ami") )
View(ami_geom)
crte_geom<-ma_fonction(crte_init, type="polygon")%>%
separate_rows(id_crte, sep = " ; ")
#CRTE
crte_init<-read.csv("N:/Transverse/Donnees_Obs/Donnees_Statistiques/ANCT/contrats-de-relance-et-de-transition-ecologique/liste-crte-com2023-20230823.csv", fileEncoding ="utf-8")
crte_init_list<-read.csv("N:/Transverse/Donnees_Obs/Donnees_Statistiques/ANCT/contrats-de-relance-et-de-transition-ecologique/liste-crte-20230823.csv", fileEncoding ="utf-8")
crte_geom<-ma_fonction(crte_init, type="polygon")%>%
separate_rows(id_crte, sep = " ; ")
View(crte_geom)
crte_groupement<-read.csv("N:/Transverse/Donnees_Obs/Donnees_Statistiques/ANCT/contrats-de-relance-et-de-transition-ecologique/liste-crte-grpt2023-20230823.csv", fileEncoding ="utf-8")
crte_gpt_data <- crte_groupement %>%
group_by(id_crte)%>%
summarise(liste_geo= paste0(unique(lib_groupement),' (', siren_groupement, ')', collapse = '; '))
View(crte_gpt_data)
crte_geom<-ma_fonction(crte_init, type="polygon")%>%
separate_rows(id_crte, sep = " ; ")%>%
rename("id_geo"="insee_com", "lib_geo"="lib_com.y" ,"id_territoire"="id_crte", "lib_territoire"="lib_crte")%>%
select(id_geo, lib_geo, id_territoire, lib_territoire)%>%
group_by(id_territoire)%>%
summarise()
View(crte_geom)
View(crte_geom)
crte_geom<-ma_fonction(crte_init, type="polygon")%>%
separate_rows(id_crte, sep = " ; ")%>%
rename("id_geo"="insee_com", "lib_geo"="lib_com.y" ,"id_territoire"="id_crte", "lib_territoire"="lib_crte")%>%
select(id_geo, lib_geo, id_territoire, lib_territoire)%>%
group_by(id_territoire)%>%
summarise()%>%
left_join(crte_init_list, by = c("id_territoire"="id_crte"))
View(crte_geom)
crte_geom<-ma_fonction(crte_init, type="polygon")%>%
separate_rows(id_crte, sep = " ; ")%>%
rename("id_geo"="insee_com", "lib_geo"="lib_com.y" ,"id_territoire"="id_crte", "lib_territoire"="lib_crte")%>%
select(id_geo, lib_geo, id_territoire, lib_territoire)%>%
group_by(id_territoire)%>%
summarise()%>%
left_join(crte_init_list, by = c("id_territoire"="id_crte"))%>%
left_join(crte_gpt_data, by= c("id_territoire"="crte") )%>%
rename("lib_territoire"="lib_crte")
crte_geom<-ma_fonction(crte_init, type="polygon")%>%
separate_rows(id_crte, sep = " ; ")%>%
rename("id_geo"="insee_com", "lib_geo"="lib_com.y" ,"id_territoire"="id_crte", "lib_territoire"="lib_crte")%>%
select(id_geo, lib_geo, id_territoire, lib_territoire)%>%
group_by(id_territoire)%>%
summarise()%>%
left_join(crte_init_list, by = c("id_territoire"="id_crte"))%>%
left_join(crte_gpt_data, by= c("id_territoire"="id_crte") )%>%
rename("lib_territoire"="lib_crte")
View(crte_geom)
#EXPORTS
st_write(obj = acv_geom,
dsn = here(paste0("geom/geojsonV2/acv_geom.geojson")),
driver = "GeoJSON", delete_layer = TRUE, append = FALSE)
st_write(obj = acv2_geom,
dsn = here(paste0("geom/geojsonV2/acv2_geom.geojson")),
driver = "GeoJSON", delete_layer = TRUE, append = FALSE)
st_write(obj = pvd_geom,
dsn = here(paste0("geom/geojsonV2/pvd_geom.geojson")),
driver = "GeoJSON", delete_layer = TRUE, append = FALSE)
st_write(obj = fs_geom,
dsn = here(paste0("geom/geojsonV2/fs_geom.geojson")),
driver = "GeoJSON", delete_layer = TRUE, append = FALSE)
st_write(obj = ti_geom,
dsn = here(paste0("geom/geojsonV2/ti_geom.geojson")),
driver = "GeoJSON", delete_layer = TRUE, append = FALSE)
st_write(obj = amm_geom,
dsn = here(paste0("geom/geojsonV2/amm_geom.geojson")),
driver = "GeoJSON", delete_layer = TRUE, append = FALSE)
st_write(obj = ami_geom,
dsn = here(paste0("geom/geojsonV2/ami_geom.geojson")),
driver = "GeoJSON", delete_layer = TRUE, append = FALSE)
st_write(obj = crte_geom,
dsn = here(paste0("geom/geojsonV2/crte_geom.geojson")),
driver = "GeoJSON", delete_layer = TRUE, append = FALSE)
View(crte_geom)
View(crte_init_list)
View(crte_init)
